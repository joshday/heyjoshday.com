<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } @media (min-width: 768px) { .sidebar-sticky {position: relative} } h5 { color:darkgrey } .headshot { width: 10rem; border: 4px solid white; border-radius: 50%; } .product-img { height: 100px; width: auto; } </style> <title>Why I use Julia</title> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-72795550-1', 'auto'); ga('send', 'pageview'); </script> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.min.js"></script> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <img class=headshot  src="/assets/portrait.jpg"> <h1><a href="/">Dr. Josh Day</a></h1> </div> <br> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item active" href="/blog/">Blog</a> </nav> <p style="font-size: .8em; padding-right: 10px;">I am a Researcher/Developer living in Carrboro, NC. When I'm not coding, I'm probably playing ultimate.</p> <br> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Search my site" type=text > <br> <input class=btn  type=submit  value=Search  formaction="/search/index.html"> </form> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=why_i_use_julia ><a href="#why_i_use_julia">Why I Use Julia</a></h1> <h2 id=multiple_dispatch_jit_dynamic_and_compiled ><a href="#multiple_dispatch_jit_dynamic_and_compiled">Multiple Dispatch &#43; JIT &#40;Dynamic and Compiled&#41;</a></h2> <p>When I am asked why I use Julia, my immediate response is “multiple dispatch”. Julia is well-known for performance, but that is only a part of what keeps me using it every day. <a href="https://en.wikipedia.org/wiki/Multiple_dispatch">Multiple dispatch</a> is a feature where different code is called by a function depending on the types of the arguments. Combined with the JIT &#40;Just-in-time compiler&#41;, Julia will automatically compile specialized code for each set of argument types the function is called with.</p> <h3 id=simple_example ><a href="#simple_example">Simple Example</a></h3> <pre><code class="julia hljs">f(x) = x + x</code></pre>
<p>I have not given Julia any hint as to what the type of the argument is, but as long as it’s a type that supports addition, Julia will compile an optimized method for it. You can peek at the LLVM compiler code with the <code>@code_llvm</code> macro.  </p>
<pre><code class="julia hljs">julia&gt; <span class=hljs-meta >@code_llvm</span> f(<span class=hljs-number >1</span>)

define i64 <span class=hljs-meta >@julia_f_62945</span>(i64) <span class=hljs-comment >#0 !dbg !5 {</span>
top:
  %<span class=hljs-number >1</span> = shl i64 %<span class=hljs-number >0</span>, <span class=hljs-number >1</span>
  ret i64 %<span class=hljs-number >1</span>
}

julia&gt; <span class=hljs-meta >@code_llvm</span> f(<span class=hljs-number >1.0</span>)

define double <span class=hljs-meta >@julia_f_62949</span>(double) <span class=hljs-comment >#0 !dbg !5 {</span>
top:
  %<span class=hljs-number >1</span> = fadd double %<span class=hljs-number >0</span>, %<span class=hljs-number >0</span>
  ret double %<span class=hljs-number >1</span>
}</code></pre>
<p>Ignoring some of the details, notice that these functions do not call the same code: one method is specific to 64-bit integers and the other for double precision floats&#33;</p>
<h3 id=what_about_more_complicated_types ><a href="#what_about_more_complicated_types">What About More Complicated Types?</a></h3>
<p>Here we will use the <a href="https://github.com/JuliaStats/Distributions.jl">Distributions</a>  package to implement a naive quantile finder using <a href="https://en.wikipedia.org/wiki/Newton&#37;27s_method">Newton&#39;s Method</a>:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=false >)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">
x_{n+1} = x_n - \frac{f(x_n)}{f&#x27;(x_n)}
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>For quantiles, we are trying to find the number <code>x</code>, for a given number <code>q</code> &#40;between 0 and 1&#41;, such that</p>
<pre><code class="julia hljs">cdf(dist, x) - q = <span class=hljs-number >0</span></code></pre>
<p>where <code>cdf</code> is the <a href="https://en.wikipedia.org/wiki/Cumulative_distribution_function">cumulative distribution function</a> for distribution <code>dist</code>. We also need the derivative of the cdf, which is the <a href="https://en.wikipedia.org/wiki/Probability_density_function">probability density function</a>, or pdf.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions

<span class=hljs-keyword >function</span> myquantile(d, q)
    out = mean(d)
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
        out -= (cdf(d, out) - q) / pdf(d, out)
    <span class=hljs-keyword >end</span>
    out
<span class=hljs-keyword >end</span></code></pre>
<p>Again, I have not told Julia anything about what <code>d</code> or <code>q</code> is, but when I provide arguments such as <code>Distributions.Normal&#40;0, 1&#41;</code> and <code>0.5</code>, Julia will compile specialized code to run the algorithm and then return the median for a standard normal distribution &#40;which is 0&#41;.</p>
<pre><code class="julia hljs">julia&gt; myquantile(Normal(<span class=hljs-number >0</span>,<span class=hljs-number >1</span>), <span class=hljs-number >.5</span>)
<span class=hljs-number >0.0</span></code></pre>
<p>Right out of the box, <code>myquantile</code> will also work with other distributions&#33;  In fact, as long as the function arguments have methods for <code>mean</code>, <code>cdf</code>, and <code>pdf</code>, it will just work&#33; If you were to implement this quantile algorithm in R, you would need to rewrite it for each distribution using the <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Normal.html"><code>dnorm</code>/<code>pnorm</code></a>  family of functions.</p>
<pre><code class="julia hljs">julia&gt; myquantile(Gamma(<span class=hljs-number >5</span>,<span class=hljs-number >1</span>), <span class=hljs-number >.7</span>)
<span class=hljs-number >5.890361313697006</span>

julia&gt; myquantile(Beta(<span class=hljs-number >2</span>, <span class=hljs-number >4</span>), <span class=hljs-number >.1</span>)
<span class=hljs-number >0.11223495854585855</span></code></pre>
<h2 id=takeaway ><a href="#takeaway">Takeaway</a></h2>
<p>The language you use has a tremendous effect on how you approach problems &#40;see <a href="https://en.wikipedia.org/wiki/Linguistic_relativity">linguistic relativity</a>&#41;. I have a background in statistics, so naturally R was one of the first languages I learned. I don’t mean to bash R &#40;language wars are boring&#41; as it is a fantastic tool for data analysis, but I often find myself asking “how do I solve this without a for loop?” since <a href="http://adv-r.had.co.nz/Performance.html">loops are slow in R</a>. In Julia, I have fewer performance obstacles, so my questions are more along the lines of “what are the methods I’m trying to accomplish this task with?”. If I can reduce a task to the operations that need to be performed, it becomes easy to write abstract yet performant code that works with any types I throw at it.</p>
<p>Multiple dispatch has become invaluable to how I code, and with Julia you get it along with stellar performance. If you want to see how I use multiple dispatch to get a lot done with very little code, check out my package <a href="https://github.com/joshday/OnlineStats.jl">OnlineStats.jl</a> for calculating statistics/models on data streams with single-pass algorithms.</p>
<p>I hope you try Julia for yourself and have the same experience I had.</p>
<p><strong>Come for the speed.  Stay for the productivity.</strong></p>
<div class=page-foot >
  <div class=copyright >
    &copy; Josh Day. Last modified: September 21, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>


<script async defer src="https://buttons.github.io/buttons.js"></script></div>
    </div>